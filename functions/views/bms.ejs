
<HTML>
        <HEAD>
                <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
                integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">  
          
          <link href="../../css/style.css" rel="stylesheet" type="text/css">
          <style>
                .open-button {
                  color: white;
                  padding: 16px 20px;
                  border: none;
                  cursor: pointer;
                  right: 28px;
                  width: 280px;
                }
              
                /* The popup form - hidden by default */
                .form-popup {
                  display: none;
                  right: 15px;
                  border: 3px solid #f1f1f1;
                  z-index: 1;
                  position: absolute;
                  background-color: white;
                }
              
                /* Add styles to the form container */
                .form-container {
                  max-width: 300px;
                  /* padding: 10px; */
                  background-color: white;
                  left:0;
                }
              
                /* Full-width input fields */
                .form-container input[type=number]{
                  width: 100%;
                  padding: 15px;
                  margin: 5px 0 22px 0;
                  border: none;
                  background: #f1f1f1;
                }
              
                /* When the inputs get focus, do something */
                .form-container input[type=number]:focus{
                  background-color: #ddd;
                  outline: none;
                }
              
                /* Set a style for the submit/login button */
                .form-container .btn {
                  background-color: #4CAF50;
                  color: white;
                  padding: 16px 20px;
                  border: none;
                  cursor: pointer;
                  width: 100%;
                  margin-bottom:10px;
                  opacity: 0.8;
                }
              
                /* Add a red background color to the cancel button */
                .form-container .cancel {
                  background-color: red;
                }
                .hover_bkgr_fricc{
                  background:rgba(0,0,0,.4);
                  cursor:pointer;
                  display:none;
                  height:100%;
                  position:fixed;
                  text-align:center;
                  top:0;
                  width:100%;
                  z-index:10000;
              }
              .hover_bkgr_fricc .helper{
                  display:inline-block;
                  height:100%;
                  vertical-align:middle;
              }
              .hover_bkgr_fricc > div {
                  background-color: #fff;
                  box-shadow: 10px 10px 60px #555;
                  display: inline-block;
                  height: auto;
                  max-width: 551px;
                  min-height: 100px;
                  vertical-align: middle;
                  width: 60%;
                  position: relative;
                  border-radius: 8px;
                  padding: 15px 5%;
              }
              .popupCloseButton {
                  background-color: #fff;
                  border: 3px solid #999;
                  border-radius: 50px;
                  cursor: pointer;
                  display: inline-block;
                  font-family: arial;
                  font-weight: bold;
                  position: absolute;
                  top: -20px;
                  right: -20px;
                  font-size: 25px;
                  line-height: 30px;
                  width: 30px;
                  height: 30px;
                  text-align: center;
              }
              .popupCloseButton:hover {
                  background-color: #ccc;
              }
              .trigger_popup_fricc {
                  cursor: pointer;
                  margin: 20px;
                  display: inline-block;
                  font-weight: bold;
                  color: white;
              }
              /*Drop Down Css*/
              
              .dropbtn {
                position: relative;
                background-color: #4d75b7;
                border: none;
                color: white;
                padding: 20px 32px;
                text-align: center;
                text-decoration: none;
                display: inline-block;
                font-size: 16px;
                margin: 20px 30px;
                cursor: pointer;
                width: 150px;
                height: 100px;
              }
              
              .dropdown {
                display: inline-block;

              }
              
              .dropdown-content {
                position: absolute;
                top:80%;
                width: 150px;
                display: none;
                background-color: #f9f9f9;
                min-width: 150px;
                left: 30px;
                box-shadow: 0px 80px 16px 0px rgba(0,0,0,0.2);
                z-index: 1;
              }
              
              .dropdown-content a {
                color: black;
                padding: 12px 16px;
                text-decoration: none;
                display: block;
              }
              
              .dropdown-content a:hover {background-color: #f1f1f1}
              
              .dropdown:hover .dropdown-content {
                display: block;
              }
              
              .dropdown:hover .dropbtn {
                background-color: #3e8e41;
              }
              .temp{
                  position: relative;
                  left:30%;
                  width: 70%;
                  height: 150px;
              }
              .temp2{
                  position: relative;
                background-color: #4d75b7;
                top:8%;
                border: none;
                color: white;
                text-align: center;
                text-decoration: none;
                display: inline-block;
                font-size: 16px;
                margin: 20px 30px;
                cursor: pointer;
                width: 150px;
                height: 100px;
              }
                /* Add some hover effects to buttons */
              
              </style>
        
        </HEAD>
        
        <body>
                <div class="mainFrame">
                        <div class="up">
                            <div class="IMG">
                            </div>
                          </div>
                          <div class="topnav">
                            <a href="/logout">Logout</a>
                                      <a href="/contact" style="align-content: center">Contact</a>
                            <%if(presents == "remonet.shalaka@gmail.com" || admin ==true){%>
                                <a href="../admin/userManagement">User Management</a>
                            <%}%>
                            <a href="../modules">Home</a>
                        </div>
        <h1 style="padding-left: 42%">Climate Data</h1>
        <div class="temp">
        <div class="dropdown">
        <button  class="dropbtn" >Node Management</button>
        <div class="dropdown-content">
          <% for(var i in bmsData.node_distinct){%>
            <a href="../dataRetrieval/bmsnodeParams?node=<%=bmsData.node_distinct[i] %>" class="trigger_popup_fricc"><%= bmsData.node_distinct[i] %></a>
          <%}%>
        </div>
        </div>
        
        <div class="dropdown" >
        <button  class="dropbtn" >Gateway Management</button>
        <div class="dropdown-content">
          <% for(var i in bmsData.gateway_distinct){%>
            <a href="../dataRetrieval/bmsgatewayParams?gateway=<%=bmsData.gateway_distinct[i] %>" class="trigger_popup_fricc"><%= bmsData.gateway_distinct[i] %></a>
          <%}%>
        </div>
        </div>
        <button class="temp2" type="button" onclick="location.href='bmsGraphs'">Data Visualization</button>
    </div>
        <table align="center" cellspacing="20" id="data">
        <tr class="columns">
          <th><input type="checkbox" onclick="toggle(this)"/>Select all</th>
          <script>
          function toggle(source) {
            checkboxes = document.getElementsByName('c');
            if (source.checked) {
                 for (var i = 0; i < checkboxes.length; i++) {
                     if (checkboxes[i].type == 'checkbox') {
                         checkboxes[i].checked = true;
                     }
                 }
             } else {
                 for (var i = 0; i < checkboxes.length; i++) {
                     console.log(i)
                     if (checkboxes[i].type == 'checkbox') {
                         checkboxes[i].checked = false;
                     }
                 }
             }
          }
          </script>
          <th>Gateway</th>
          <th>Node</th>
        <th style="padding-left: 20px;">DateTime</th>
        <th><a href="#" class="trigger_popup_fricc" onclick="openFormTemperature()">Temperature</a></th>
        <div class="hover_bkgr_fricc" id="myForm_temperature">
          <form action="/dataRetrieval/bmsTemperature" class="form-container" method="post">
        
            <span class="helper"></span>
              <div>
                <h1>Set Limits</h1>
                <label for="upperlimit"><b>Upper Limit</b></label>
                <input type="number" placeholder="Enter Upper Limit" name="UpperLimitTemperature" value="" required><br>


                <label for="lowerlimit"><b>Lower Limit</b></label>
                    <input type="number" placeholder="Enter Lower Limit" name="LowerLimitTemperature" value="" required><br>        
        
                <button type="submit" class="btn">Save</button>
                <button type="button" class="btn cancel" onclick="closeFormTemperature()">Close</button>
            </div>
        
        
          </form>
        </div>
        
        <th><a href="#" class="trigger_popup_fricc" onclick="openFormRelativeHumidity()">RelativeHumidity</a></th>
        <div class="hover_bkgr_fricc" id="myForm_relativehumidity">
          <form action="/dataRetrieval/bmsRelativeHumidity" class="form-container" method="post">
        
            <span class="helper"></span>
              <div>
                <h1>Set Limits</h1>
                <label for="upperlimit"><b>Upper Limit</b></label>
                <input type="number" placeholder="Enter Upper Limit" name="UpperLimitRelativeHumidity" value="" required><br>

                    <label for="lowerlimit"><b>Lower Limit</b></label>
                    <input type="number" placeholder="Enter Lower Limit" name="LowerLimitRelativeHumidity" value="" required><br>        
        
                <button type="submit" class="btn">Save</button>
                <button type="button" class="btn cancel" onclick="closeFormRelativeHumidity()">Close</button>
            </div>
        
        
          </form>
        </div>
        
        <th><a href="#" class="trigger_popup_fricc" onclick="openFormAmbientLight()">AmbientLight</a></th>
        <div class="hover_bkgr_fricc" id="myForm_ambientlight">
          <form action="/dataRetrieval/bmsAmbientLight" class="form-container" method="post">
        
            <span class="helper"></span>
              <div>
                <h1>Set Limits</h1>

                <label for="upperlimit"><b>Upper Limit</b></label>
                <input type="number" placeholder="Enter Upper Limit" name="UpperLimitAmbientLight" value="" required><br>

                    <label for="lowerlimit"><b>Lower Limit</b></label>
                    <input type="number" placeholder="Enter Lower Limit" name="LowerLimitAmbientLight" value="" required><br>        
        
                <button type="submit" class="btn">Save</button>
                <button type="button" class="btn cancel" onclick="closeFormAmbientLight()">Close</button>
            </div>
        
        
          </form>
        </div>
        
        
        <script>
         function openFormTemperature() {document.getElementById("myForm_temperature").style.display = "block";}
        function closeFormTemperature() {document.getElementById("myForm_temperature").style.display = "none";}
        function openFormRelativeHumidity() {document.getElementById("myForm_relativehumidity").style.display = "block";}
        function closeFormRelativeHumidity() {document.getElementById("myForm_relativehumidity").style.display = "none";}
        function openFormAmbientLight() {document.getElementById("myForm_ambientlight").style.display = "block";}
        function closeFormAmbientLight() {document.getElementById("myForm_ambientlight").style.display = "none";}
        </script>
        <% for(var i in bmsData.gateway){%>
        <tr>
          <td class="calign"><input type="checkbox" name = "c"/></td>
          <td class="ralign"><%= bmsData.gateway[i] %></td>
          <td class="ralign"><%= bmsData.node[i] %></td>
          <td class="calign"><%= bmsData.dateTime[i] %></td>
            <% if(bmsData.temperature[i] < bmsData.temp_lower[i]){ %>
            <td class="ralign" style="padding-left: 60px;"><font color="blue"><%= bmsData.temperature[i] %></font></td>
          <% }else if(bmsData.temperature[i] > bmsData.temp_upper[i]){ %>
            <td class="ralign" style="padding-left: 60px;"><font color="red"><%= bmsData.temperature[i] %></font></td>
          <% } else { %>
            <td class="ralign" style="padding-left: 60px;"><font color="green"><%= bmsData.temperature[i] %></font></td>
          <% }%>
        
          <% if(bmsData.relativeHumidity[i] < bmsData.rh_lower[i]){ %>
            <td class="ralign" style="padding-left: 70px;"><font color="blue"><%= bmsData.relativeHumidity[i] %></font></td>
          <% }else if(bmsData.relativeHumidity[i] > bmsData.rh_upper[i]){ %>
            <td class="ralign" style="padding-left: 70px;"><font color="red"><%= bmsData.relativeHumidity[i] %></font></td>
          <% } else { %>
            <td class="ralign"style="padding-left: 70px;"><font color="green"><%= bmsData.relativeHumidity[i] %></font></td>
          <% }%>
        
          <% if(bmsData.ambientLight[i] < bmsData.al_lower[i]){ %>
            <td class="ralign"style="padding-left: 60px;"><font color="blue"><%=bmsData.ambientLight[i] %></font></td>
          <% }else if(bmsData.ambientLight[i] > bmsData.al_upper[i]){ %>
            <td class="ralign"style="padding-left: 60px;"><font color="red"><%= bmsData.ambientLight[i] %></font></td>
          <% } else { %>
            <td class="ralign"style="padding-left: 60px;"><font color="green"><%= bmsData.ambientLight[i] %></font></td>
          <% }%>
        
        </tr>
        <%}%>
        </tr>
        </table>
        
        <% include footer.ejs %>
                </div>
        </body>
        </HTML>
        